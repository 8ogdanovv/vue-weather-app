import{r as l,o as p,w as h,a as k,b as t,c as s,F as w,d as S,e as N,t as y,f as d,g as D,h as I,i as u,j as P,k as O,_ as F,l as J,m as W,P as b}from"./index-h_30geJQ.js";const B={key:0},L={key:0,class:"content favorites"},$={key:1},j={style:{padding:"1rem"}},x={key:1,class:"wrapper"},V={__name:"Favorites",setup(T){const r=l(!1),g=l(sessionStorage.getItem("favsDays")||1),n=l(JSON.parse(localStorage.getItem("favorites"))||[]),_=async()=>{if(r.value=!1,localStorage.getItem("favorites")){const a=JSON.parse(localStorage.getItem("favorites")),m=a.map(e=>e.city.name),i=a.map(async e=>await I(e.city.name)),c=await Promise.all(i);u.global.messages.en.cityNamesPinned=m.join("_"),u.global.messages.uk.cityNamesPinned=c.join("_");const o=new Date().toISOString().slice(0,10),v=a.map(async e=>{if(!e.weather||e.weather.current.time.slice(0,10)!==o){const f=await P(e.city.latitude,e.city.longitude);e.weather=f}return e});localStorage.setItem("favorites",JSON.stringify(await Promise.all(v)))}n.value=JSON.parse(localStorage.getItem("favorites"))||[],r.value=!0};return p(()=>{_()}),h(JSON.parse(localStorage.getItem("favorites")),()=>window.location.reload()),(a,m)=>{const i=k("router-link");return r.value===!0?(t(),s("div",B,[n.value.length?(t(),s("div",L,[(t(!0),s(w,null,S(n.value,(c,o)=>(t(),O(F,{key:o,cityWeather:c,displayDays:g.value,index:o},null,8,["cityWeather","displayDays","index"]))),128))])):(t(),s("div",$,[N("h2",j,y(a.$t("noPinned")),1),d(i,{to:"/"},{default:D(()=>[J(y(a.$t("backToHome")),1)]),_:1})])),d(W,{less:1,more:7,storageKey:"favsDays"})])):(t(),s("div",x,[d(b)]))}}};export{V as default};
